@use "../mixins" as mixins;
@use "sass:map";
@use "../variables" as v;
@use "../functions" as f;

$default-variables: (
        layout: v.$layout,
        misc: v.$misc,
);

@mixin generate-theme($theme-options: null) {
  $defaults: (
          scale-light: v.$light-mode,
          scale-dark: v.$dark-mode,
          theme-name: "nuitral",
          light-class: "nuitral-light-mode",
          dark-class: "nuitral-dark-mode",
          light-text-color: v.$black,
          dark-text-color: v.$white,
          variables: $default-variables,
  );

  $config: map.deep-merge($defaults, $theme-options);

  $scale-light: map.get($config, scale-light);
  $scale-dark: map.get($config, scale-dark);
  $theme-name: map.get($config, theme-name);
  $light-class: map.get($config, light-class);
  $dark-class: map.get($config, dark-class);
  $light-text-color: map.get($config, light-text-color);
  $dark-text-color: map.get($config, dark-text-color);
  $variables: map.get($config, variables);

  // THEME AND MODE

  [nuitral-theme="#{$theme-name}"].#{$light-class} {
    --text-color: #{$light-text-color};
    --box-shadow: #{v.$box-shadow};
    --box-shadow-focus: #{v.$box-shadow-focus};

    @include mixins.generate-css-variables($scale-light);
    @include mixins.generate-text-and-state-variables(
                    $scale-light,
                    $light-text-color,
                    $dark-text-color
    );
  }

  [nuitral-theme="#{$theme-name}"].#{$dark-class} {
    --text-color: #{$dark-text-color};
    --box-shadow: #{v.$box-shadow-dark};
    --box-shadow-focus: #{v.$box-shadow-dark-focus};

    @include mixins.generate-css-variables($scale-dark);
    @include mixins.generate-text-and-state-variables(
                    $scale-dark,
                    $light-text-color,
                    $dark-text-color
    );
  }

  //BOX
  @include mixins.generate-box(v.$border-radius-molecules);
  @include mixins.generate-box-background-classes($scale-light);

  //BUTTON
  @include mixins.generate-button(
                  v.$height-atoms,
                  v.$transitions-global,
                  map.get($variables, misc)
  );
  @include mixins.generate-button-background-classes(
                  $scale-light,
                  var(--box-shadow),
                  var(--box-shadow-focus)
  );

  //CARD
  @include mixins.generate-card(v.$border-radius-atoms);
  @include mixins.generate-card-background-classes($scale-light);

  //INPUT
  @include mixins.generate-input(
                  v.$primary,
                  v.$background-400,
                  v.$background-700,
                  v.$background-700,
                  v.$transitions-global,
                  v.$height-atoms,
                  map.get($variables, misc)
  );
  @include mixins.generate-input-classes();

  //TABS
  @include mixins.generate-tabs();

  //TAB
  @include mixins.generate-tab(v.$height-atoms, v.$transitions-global);
  @include mixins.generate-tab-classes($scale-light);

  //SPACING
  @include mixins.generate-spacing(v.$directions, v.$spacers);

  //LAYOUT
  @include mixins.generate-layout($variables);

  //TEXT COLORS
  @include mixins.generate-color-classes($scale-light);

  //BACKGROUND COLORS
  @include mixins.generate-background-classes(
                  $scale-light,
                  v.$transitions-global
  );
}
